<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <link rel="stylesheet" href="style1.css">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>图书馆交叉分析</title>
    <!-- Bootstrap -->
    <!--<link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="../vendors/iCheck/skins/flat/green.css" rel="stylesheet">

    <!-- bootstrap-progressbar -->
    <link href="../vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <!-- JQVMap -->
    <link href="../vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet"/>
    <!-- bootstrap-daterangepicker -->
    <link href="../vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/font-awesome-ie7.min.css" rel="stylesheet">
    <link href="css/large-chart.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="../vendors/jquery/dist/jquery.min.js"></script>
    <!-- 引入动态权限加载函数(小章)-->
    <script src="js/datepicker/permissionAllocation.js"></script>
    <script src="../libraryreport/template.js"></script>
</head>
<body>
<div class="page chapter" id="CrossAnalysisByDay" style="height: auto; width: 70%">
    <div class="second-title"> 每日各项分析  </div>
    <div class="pagination" style="bottom: 30px"></div>
</div>


<div class="page chapter" id="UtilizationAnalysis" style="height: auto ; width: 70%">
    <div class="second-title">图书馆IC空间利用率分析</div>
    <div class="pagination" style="bottom: 30px"></div>
</div>

<div class="page chapter" id="CrossAnalysisByMonth" style="height: auto; width: 70%">
    <div class="second-title">每月各项分析</div>
    <div class="pagination" style="bottom: 30px"></div>
</div>

<div class="page chapter" id="crossAnalysisByMonthOfUnderGraduate" style="height: auto; width: 70%">
    <div class="second-title">本科生各学院年度分析</div>
    <div class="pagination" style="bottom: 30px"></div>
</div>

<div class="page chapter" id="crossAnalysisByMonthOfGraduate" style="height: auto; width: 70%">
    <div class="second-title">研究生各学院年度分析</div>
    <div class="pagination" style="bottom: 30px"></div>
</div>

<script type="application/javascript">
    function getCrossAnalysisUtilizationRatio() {
        $.get('../../cross_analysis/getCrossAnalysisUtilizationRatio', function (data) {
            console.log(data);
            var result = [];
            for(var i = 0; i < data.ic_type.length; i++) {
                var temp = new Object();
                temp.ic_type = data.ic_type[i];
                temp.day_use_account = data.day_use_account[i];
                temp.month_use_account = data.month_use_account[i];
                temp.year_use_account = data.year_use_account[i];
                console.log(temp);
                result.push(temp);
            }
            $("#UtilizationAnalysis").append("<div class='table Utilization'></div>");
            var html = template('CrossAnalysisUtilization', {param: result});
            $(".Utilization" ).html(html);

            console.log(result);
        });
    }
</script>

<script language="javascript" type="application/javascript">
    $(function(){
        CrossAnalysisByDay();
        getCrossAnalysisUtilizationRatio();
        getCrossAnalysisByMonth();
        getCrossAnalysisByAcademyInUnderGraduate();
        getCrossAnalysisByAcademyInGraduate();
    })
</script>
<script type="application/javascript">
    function CrossAnalysisByDay() {
        $.get('../../cross_analysis/CrossAnalysisByDay', function (data) {
            console.log(data);
            $("#CrossAnalysisByDay").append("<div class='table temp'></div>");
            var html = template('CrossAnalysis1', {param: data});//
            $("#CrossAnalysisByDay").find(".temp" ).html(html);
        });
    }
</script>


<script type="application/javascript">
    function getCrossAnalysisByMonth() {
        $.get('../../cross_analysis/getCrossAnalysisByMonth', function (data) {
            // console.log(data[1].month);
            // console.log(data[1].gctrl_times);
             console.log(data);
            $("#CrossAnalysisByMonth").append("<div class='table temp'></div>");
            var html = template('CrossAnalysis3', {param: data});
            $("#CrossAnalysisByMonth").find(".temp" ).html(html);
        });
    }
</script>

<script type="application/javascript">
function getCrossAnalysisByAcademyInUnderGraduate() {
    $.get('../../cross_analysis/getCrossAnalysisByAcademyInUnderGraduate', function (data) {
        // console.log(data);
        for (var key in data) {
           console.log(key);
            $("#crossAnalysisByMonthOfUnderGraduate").append("<div style=\"text-align: center\">" + key + "</div><div class='table " + key + "'></div>");
            var html = template('CrossAnalysis', {param: data[key]});
            $("#crossAnalysisByMonthOfUnderGraduate").find("." + key).html(html);
        }
    });
}

function getCrossAnalysisByAcademyInGraduate() {
    $.get('../../cross_analysis/getCrossAnalysisByAcademyInGraduate', function (data) {
        for (var key in data) {
            $("#crossAnalysisByMonthOfGraduate").append("<div style=\"text-align: center\">" + key + "</div><div class='table " + key + "'></div>");
            var html = template('CrossAnalysis', {param: data[key]});
            $("#crossAnalysisByMonthOfGraduate").find("." + key).html(html);
        }
    });
}
</script>

<script type="text/html" id="CrossAnalysis3">
    <table class="table-cyan" cellspacing="0" cellpadding="0" width="100%">
        <tr>
            <th>月份</th>
            <th>借阅次数</th>
            <th>进馆人数</th>
            <th>研修间</th>
            <th>电子阅览室</th>
            <th>座位数</th>
            <th>打印数</th>
        </tr>
        {{each param as p}}
        <tr>
            <td>{{p.month}}</td>
            <td>{{p.book_lend_times}}</td>
            <td>{{p.gctrl_times}}</td>
            <td>{{p.croom_times}}</td>
            <td>{{p.eread_times}}</td>
            <td>{{p.seat_times}}</td>
            <td>{{p.print_times}}</td>
        </tr>
        {{/each}}
    </table>
</script>

<script type="text/html" id="CrossAnalysis1">
    <table class="table-cyan" cellspacing="0" cellpadding="0" width="100%">
        <tr>
            <th>小时</th>
            <th>借阅次数</th>
            <th>进馆人数</th>
            <th>研修间</th>
            <th>电子阅览室</th>
            <th>座位数</th>
            <th>打印数</th>
        </tr>
        {{each param as p}}
        <tr>
            <td>{{p.hour}}</td>
            <td>{{p.book_lend_times}}</td>
            <td>{{p.gctrl_times}}</td>
            <td>{{p.croom_times}}</td>
            <td>{{p.eread_times}}</td>
            <td>{{p.seat_times}}</td>
            <td>{{p.print_times}}</td>
        </tr>
        {{/each}}
    </table>
</script>

<script>
    template.helper('toFloat', function (data) {
        if( isNaN(data) || data == Infinity ) {
            return 0.00;
        }else{
            return parseFloat(data).toFixed(2)
        }
    })
</script>

<script type="text/html" id="CrossAnalysis">
    <table class="table-cyan" cellspacing="0" cellpadding="0" width="100%">
        <tr>
            <th>月份</th>
            <th>借阅次数(次/人)</th>
            <th>进馆人数(次/人)</th>
            <th>研修间(次/人)</th>
            <th>电子阅览室(次/人)</th>
            <th>座位数(次/人)</th>
            <th>打印数(次/人)</th>
        </tr>
        {{each param as p}}
        <tr>
            <td>{{p.month}}</td>
            <td>{{p.book_lend_times}}/{{toFloat p.book_lend_times/p.acdemy_stu_amount}}</td>
            <td>{{p.gctrl_times}}/{{toFloat p.gctrl_times/p.acdemy_stu_amount}}</td>
            <td>{{p.croom_times}}/{{toFloat p.croom_times/p.acdemy_stu_amount}}</td>
            <td>{{p.eread_times}}/{{toFloat p.eread_times/p.acdemy_stu_amount}}</td>
            <td>{{p.seat_times}}/{{toFloat p.seat_times/p.acdemy_stu_amount}}</td>
            <td>{{p.print_times}}/{{toFloat p.print_times/p.acdemy_stu_amount}}</td>
        </tr>
        {{/each}}
    </table>
</script>

<script type="text/html" id="CrossAnalysisUtilization">
    <table class="table-cyan" cellspacing="0" cellpadding="0" width="100%">
        <tr>
            <th>类型</th>
            <th>日使用</th>
            <th>月使用</th>
            <th>年使用</th>
        </tr>
        {{each param as p}}
        <tr>
            <td>{{p.ic_type}}</td>
            <td>{{p.day_use_account}}</td>
            <td>{{p.month_use_account}}</td>
            <td>{{p.year_use_account}}</td>
        </tr>
        {{/each}}
    </table>
</script>



<!-- Bootstrap -->
<!--<script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>-->
<!-- FastClick -->
<script src="../vendors/fastclick/lib/fastclick.js"></script>
<!-- NProgress -->
<script src="../vendors/nprogress/nprogress.js"></script>
<!-- Chart.js -->
<script src="../vendors/Chart.js/dist/Chart.min.js"></script>
<!-- gauge.js -->
<script src="../vendors/gauge.js/dist/gauge.min.js"></script>
<!-- bootstrap-progressbar -->
<script src="../vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<!-- iCheck -->
<script src="../vendors/iCheck/icheck.min.js"></script>
<!-- Skycons -->
<script src="../vendors/skycons/skycons.js"></script>
<!-- Flot -->
<script src="../vendors/Flot/jquery.flot.js"></script>
<script src="../vendors/Flot/jquery.flot.pie.js"></script>
<script src="../vendors/Flot/jquery.flot.time.js"></script>
<script src="../vendors/Flot/jquery.flot.stack.js"></script>
<script src="../vendors/Flot/jquery.flot.resize.js"></script>
<!-- Flot plugins -->
<script src="../vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
<script src="../vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
<script src="../vendors/flot.curvedlines/curvedLines.js"></script>
<!-- DateJS -->
<script src="../vendors/DateJS/build/date.js"></script>
<!-- JQVMap -->
<script src="../vendors/jqvmap/dist/jquery.vmap.js"></script>
<script src="../vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
<script src="../vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>
<!-- bootstrap-daterangepicker -->
<script src="../vendors/moment/min/moment.min.js"></script>
<script src="../vendors/bootstrap-daterangepicker/daterangepicker.js"></script>

<!-- ECharts -->
<!--<script src="../vendors/echarts/dist/echarts.min.js"></script>-->
<!--<script src="../vendors/echarts/map/js/world.js"></script>-->

<!-- Custom Theme Scripts -->
<script src="../build/js/custom.min.js"></script>
</body>
</html>